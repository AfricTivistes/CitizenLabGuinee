---
import { Icon } from 'astro-icon/components';

// Custom type for WordPress team members
interface WordPressTeamMember {
  title: string;
  featuredImage?: {
    node?: {
      mediaItemUrl?: string;
      altText?: string;
    };
  };
  social?: {
    facebook?: string;
    instagram?: string;
    linkedin?: string;
    twitter?: string;
  };
  fonctions?: {
    equipe?: string;
    fonction?: string;
  };
}

export interface Props {
  member: WordPressTeamMember;
}

const { member } = Astro.props;
// Utiliser sourceUrl ou mediaItemUrl selon ce qui est disponible
const imageUrl = member.featuredImage?.node?.sourceUrl || member.featuredImage?.node?.mediaItemUrl;
---

<div class="bg-white dark:bg-slate-900 rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
  <div class="w-full h-64 sm:h-80 overflow-hidden">
    {imageUrl ? (
      <img
        src={imageUrl}
        alt={member.featuredImage?.node?.altText || member.title || 'Photo du membre'}
        class="w-full h-full object-cover bg-gray-300 dark:bg-slate-700"
        loading="lazy"
        decoding="async"
      />
    ) : (
      <div class="w-full h-full bg-gradient-to-br from-gray-200 to-gray-300 dark:from-slate-700 dark:to-slate-800 flex items-center justify-center">
        <span class="text-gray-500 dark:text-gray-400 text-sm">Pas d'image</span>
      </div>
    )}
  </div>
  <div class="px-4 py-6 text-center">
    <h2 class="font-bold text-lg text-gray-900 dark:text-white mb-2">{member.title}</h2>
    {member.excerpt && (
      <div class="text-sm text-gray-600 dark:text-gray-400 mt-2 leading-relaxed" 
           set:html={member.excerpt.length > 80 ? member.excerpt.substring(0, 80) + '...' : member.excerpt}>
      </div>
    )}

    <div class="flex justify-center gap-3 mt-3">
      {member.social?.facebook && (
              <a href={member.social.facebook} target="_blank" rel="noopener noreferrer">
                <Icon
                      name="tabler:brand-facebook"
                      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
                />
              </a>
            )}
            {member.social?.instagram && (
              <a href={member.social.instagram} target="_blank" rel="noopener noreferrer">
                <Icon
                      name="tabler:brand-instagram"
                      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
                />
              </a>
            )}
            {member.social?.linkedin && (
              <a href={member.social.linkedin} target="_blank" rel="noopener noreferrer">
                <Icon
                      name="tabler:brand-linkedin"
                      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
                />
              </a>
            )}
            {member.social?.twitter && (
              <a href={member.social.twitter} target="_blank" rel="noopener noreferrer">
                <Icon
                      name="tabler:brand-x"
                      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
                />
              </a>
            )}
    </div>
  </div>
</div>